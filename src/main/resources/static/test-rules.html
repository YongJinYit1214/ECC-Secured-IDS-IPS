<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ ECC-IDS-IPS Rule Testing Suite</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .subtitle {
            text-align: center;
            margin-bottom: 30px;
            opacity: 0.9;
            font-size: 1.2em;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .test-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.2);
        }
        .test-card h3 {
            margin: 0 0 10px 0;
            color: #FFD700;
            font-size: 1.3em;
        }
        .test-card .rule-id {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        .test-card .severity {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
            margin-left: 10px;
        }
        .severity.critical { background: #ff4757; }
        .severity.high { background: #ff6b35; }
        .severity.medium { background: #ffa502; }
        .test-card p {
            margin: 10px 0;
            line-height: 1.5;
            opacity: 0.9;
        }
        .test-button {
            background: linear-gradient(45deg, #ff6b35, #ff4757);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s ease;
            font-size: 1em;
        }
        .test-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
        }
        .test-button:active {
            transform: scale(0.95);
        }
        .status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
        .status.success {
            background: rgba(46, 204, 113, 0.3);
            color: #2ecc71;
            border: 1px solid #2ecc71;
        }
        .status.error {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
        .status.testing {
            background: rgba(52, 152, 219, 0.3);
            color: #3498db;
            border: 1px solid #3498db;
        }
        .dashboard-link {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }
        .dashboard-link a {
            color: #FFD700;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2em;
        }
        .dashboard-link a:hover {
            text-shadow: 0 0 10px #FFD700;
        }
        .warning {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #ffc107;
            color: #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ ECC-IDS-IPS Rule Testing Suite</h1>
        <p class="subtitle">Test each detection rule with realistic attack simulations</p>
        
        <div class="warning">
            ‚ö†Ô∏è <strong>Important:</strong> These tests simulate real attacks. Only run on your own system for testing purposes!
        </div>

        <div class="dashboard-link">
            üìä <a href="/dashboard.html" target="_blank">Open Security Dashboard</a> to see alerts in real-time
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <button class="test-button" onclick="testAllRules()" style="background: linear-gradient(45deg, #2ecc71, #27ae60); max-width: 300px; font-size: 1.1em; padding: 15px 30px;">
                üöÄ Test All Rules (Auto-Sequence)
            </button>
        </div>

        <div class="test-grid">
            <!-- Rule 1: Port Scanning -->
            <div class="test-card">
                <div class="rule-id">RULE_001</div>
                <div class="severity high">HIGH</div>
                <h3>üîç Port Scanning Detection</h3>
                <p>Simulates aggressive port scanning by making rapid connections to multiple ports.</p>
                <p><strong>Trigger:</strong> 50+ connections per minute to common ports</p>
                <button class="test-button" onclick="testPortScanning()">üöÄ Test Port Scanning</button>
                <div id="status1" class="status"></div>
            </div>

            <!-- Rule 2: Brute Force -->
            <div class="test-card">
                <div class="rule-id">RULE_002</div>
                <div class="severity critical">CRITICAL</div>
                <h3>üîê Brute Force Detection</h3>
                <p>Simulates brute force attacks on authentication services.</p>
                <p><strong>Trigger:</strong> 25+ failed authentication attempts</p>
                <button class="test-button" onclick="testBruteForce()">üöÄ Test Brute Force</button>
                <div id="status2" class="status"></div>
            </div>

            <!-- Rule 3: Malicious Payload -->
            <div class="test-card">
                <div class="rule-id">RULE_003</div>
                <div class="severity critical">CRITICAL</div>
                <h3>üíÄ Malicious Payload Detection</h3>
                <p>Tests detection of SQL injection, XSS, and command injection patterns.</p>
                <p><strong>Trigger:</strong> Known attack patterns in HTTP requests</p>
                <button class="test-button" onclick="testMaliciousPayload()">üöÄ Test Malicious Payload</button>
                <div id="status3" class="status"></div>
            </div>

            <!-- Rule 4: Data Exfiltration -->
            <div class="test-card">
                <div class="rule-id">RULE_004</div>
                <div class="severity high">HIGH</div>
                <h3>üì§ Data Exfiltration Detection</h3>
                <p>Simulates large data transfers that could indicate data theft.</p>
                <p><strong>Trigger:</strong> 10+ large packets (8KB+) per minute</p>
                <button class="test-button" onclick="testDataExfiltration()">üöÄ Test Data Exfiltration</button>
                <div id="status4" class="status"></div>
            </div>

            <!-- Rule 5: Known Malicious IP -->
            <div class="test-card">
                <div class="rule-id">RULE_005</div>
                <div class="severity critical">CRITICAL</div>
                <h3>üåê Known Malicious IP Detection</h3>
                <p>Tests detection of traffic from known malicious IP ranges.</p>
                <p><strong>Trigger:</strong> Connections from suspicious IP patterns</p>
                <button class="test-button" onclick="testMaliciousIP()">üöÄ Test Malicious IP</button>
                <div id="status5" class="status"></div>
            </div>

            <!-- Rule 6: DDoS Attack -->
            <div class="test-card">
                <div class="rule-id">RULE_006</div>
                <div class="severity critical">CRITICAL</div>
                <h3>‚ö° DDoS Attack Detection</h3>
                <p>Simulates distributed denial of service attack patterns.</p>
                <p><strong>Trigger:</strong> 500+ connections from 50+ sources per minute</p>
                <button class="test-button" onclick="testDDoS()">üöÄ Test DDoS Attack</button>
                <div id="status6" class="status"></div>
            </div>

            <!-- Rule 7: Lateral Movement -->
            <div class="test-card">
                <div class="rule-id">RULE_007</div>
                <div class="severity high">HIGH</div>
                <h3>üîÑ Lateral Movement Detection</h3>
                <p>Tests detection of network reconnaissance and lateral movement.</p>
                <p><strong>Trigger:</strong> 20+ connections to Windows admin ports</p>
                <button class="test-button" onclick="testLateralMovement()">üöÄ Test Lateral Movement</button>
                <div id="status7" class="status"></div>
            </div>

            <!-- Rule 8: Cryptocurrency Mining -->
            <div class="test-card">
                <div class="rule-id">RULE_008</div>
                <div class="severity medium">MEDIUM</div>
                <h3>‚õèÔ∏è Cryptocurrency Mining Detection</h3>
                <p>Tests detection of unauthorized cryptocurrency mining activity.</p>
                <p><strong>Trigger:</strong> 10+ connections to mining ports per minute</p>
                <button class="test-button" onclick="testCryptoMining()">üöÄ Test Crypto Mining</button>
                <div id="status8" class="status"></div>
            </div>
        </div>

        <div class="dashboard-link">
            üéØ After running tests, check the <a href="/dashboard.html" target="_blank">Security Dashboard</a> for generated alerts!
        </div>
    </div>

    <script>
        function showStatus(ruleNum, type, message) {
            const status = document.getElementById(`status${ruleNum}`);
            status.className = `status ${type}`;
            status.textContent = message;
            status.style.display = 'block';
        }

        function testPortScanning() {
            showStatus(1, 'testing', 'üîÑ Simulating port scanning...');

            fetch('/api/v1/test/port-scan', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                showStatus(1, 'success', '‚úÖ Port scanning simulation completed! Check dashboard for alerts.');
            })
            .catch(error => {
                showStatus(1, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testBruteForce() {
            showStatus(2, 'testing', 'üîÑ Simulating brute force attack...');

            fetch('/api/v1/test/brute-force', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(2, 'success', '‚úÖ Brute force simulation completed! Check dashboard for alerts.');
                }, 2000);
            })
            .catch(error => {
                showStatus(2, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testMaliciousPayload() {
            showStatus(3, 'testing', 'üîÑ Testing malicious payload detection...');

            fetch('/api/v1/test/malicious-payload', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(3, 'success', '‚úÖ Malicious payload tests completed! Check dashboard for alerts.');
                }, 1500);
            })
            .catch(error => {
                showStatus(3, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testDataExfiltration() {
            showStatus(4, 'testing', 'üîÑ Simulating data exfiltration...');

            fetch('/api/v1/test/data-exfiltration', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(4, 'success', '‚úÖ Data exfiltration simulation completed! Check dashboard for alerts.');
                }, 3000);
            })
            .catch(error => {
                showStatus(4, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testMaliciousIP() {
            showStatus(5, 'testing', 'üîÑ Testing malicious IP detection...');

            fetch('/api/v1/test/malicious-ip', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    source_ip: '185.220.100.240',
                    test_type: 'malicious_ip_simulation'
                })
            })
            .then(response => response.text())
            .then(data => {
                showStatus(5, 'success', '‚úÖ Malicious IP test completed! Check dashboard for alerts.');
            })
            .catch(error => {
                showStatus(5, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testDDoS() {
            showStatus(6, 'testing', 'üîÑ Simulating DDoS attack...');

            fetch('/api/v1/test/ddos', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(6, 'success', '‚úÖ DDoS simulation completed! Check dashboard for alerts.');
                }, 4000);
            })
            .catch(error => {
                showStatus(6, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testLateralMovement() {
            showStatus(7, 'testing', 'üîÑ Simulating lateral movement...');

            fetch('/api/v1/test/lateral-movement', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(7, 'success', '‚úÖ Lateral movement simulation completed! Check dashboard for alerts.');
                }, 3000);
            })
            .catch(error => {
                showStatus(7, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testCryptoMining() {
            showStatus(8, 'testing', 'üîÑ Simulating cryptocurrency mining...');

            fetch('/api/v1/test/crypto-mining', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                setTimeout(() => {
                    showStatus(8, 'success', '‚úÖ Cryptocurrency mining simulation completed! Check dashboard for alerts.');
                }, 3000);
            })
            .catch(error => {
                showStatus(8, 'error', '‚ùå Test failed: ' + error.message);
            });
        }

        function testAllRules() {
            // Show testing status for all rules
            for (let i = 1; i <= 8; i++) {
                showStatus(i, 'testing', '‚è≥ Queued for testing...');
            }

            fetch('/api/v1/test/run-all', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'}
            })
            .then(response => response.text())
            .then(data => {
                // Update status messages with timing
                setTimeout(() => showStatus(5, 'success', '‚úÖ Malicious IP test completed!'), 1000);
                setTimeout(() => showStatus(1, 'success', '‚úÖ Port scanning test completed!'), 3000);
                setTimeout(() => showStatus(2, 'success', '‚úÖ Brute force test completed!'), 6000);
                setTimeout(() => showStatus(3, 'success', '‚úÖ Malicious payload test completed!'), 8000);
                setTimeout(() => showStatus(4, 'success', '‚úÖ Data exfiltration test completed!'), 12000);
                setTimeout(() => showStatus(6, 'success', '‚úÖ DDoS test completed!'), 17000);
                setTimeout(() => showStatus(7, 'success', '‚úÖ Lateral movement test completed!'), 21000);
                setTimeout(() => showStatus(8, 'success', '‚úÖ Crypto mining test completed!'), 25000);

                setTimeout(() => {
                    alert('üéâ All detection rule tests completed!\n\nCheck the Security Dashboard to see all the generated alerts.\n\nEach rule should have triggered at least one alert.');
                }, 26000);
            })
            .catch(error => {
                for (let i = 1; i <= 8; i++) {
                    showStatus(i, 'error', '‚ùå Test sequence failed');
                }
            });
        }
    </script>
</body>
</html>
